extends: feature.crm # Placeholder since no Level-0 exists

bounded_context: crm
consistency_groups:
  - id: lead
    name: Lead
  - id: quote
    name: Quote
  - id: contract
    name: Contract
commands:
  - id: convert_lead
    name: ConvertLead
    target: lead
    intent: 'Create/link Account and optionally Opportunity'
    preconditions: []
    postconditions:
      emits: ['lead_converted']

  - id: accept_quote
    name: AcceptQuote
    target: quote
    intent: 'Customer accepts terms for a single Opportunity'
    preconditions: ['quote_aligns_with_opp']
    postconditions:
      emits: ['quote_accepted']

  - id: activate_contract
    name: ActivateContract
    target: contract
    intent: 'Make contract effective'
    preconditions:
      ['contract_after_won', 'one_active_contract_per_account_offering']
    postconditions:
      emits: ['contract_activated']