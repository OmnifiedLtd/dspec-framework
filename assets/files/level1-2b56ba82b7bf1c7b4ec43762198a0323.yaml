extends: level0.yaml

consistency_groups:
  - id: product
    name: Product
  - id: variant
    name: Variant
commands:
  - id: activate-product
    name: ActivateProduct
    target: product
    intent: 'Publish product under a Brand'
    preconditions: ['unique-model-code-per-brand']
    postconditions:
      emits: ['product-activated']
      transitions: ['draft -> active']
    transactional_expectation: 'starts-saga' # if using reservation-then-confirm
    failure_modes:
      - violates: 'unique-model-code-per-brand'
        outcome: 'reject duplicate-model-code'

  - id: activate-variant
    name: ActivateVariant
    target: variant
    intent: 'Publish purchasable SKU'
    preconditions: ['variant-sku-unique-per-product']
    postconditions:
      emits: ['variant-activated']

queries:
  - id: get-product
    name: GetProduct
    intent: 'Show product details on PDP'
    parameters:
      - name: productId
        type: string
    returns:
      type: ProductDetails
      description: 'Rich product data including all active variants'

  - id: list-products-by-brand
    name: ListProductsByBrand
    intent: 'Show brand landing page'
    parameters:
      - name: brandId
        type: string
    returns:
      type: List<ProductSummary>
      description: 'Paginated list of active products for the brand'