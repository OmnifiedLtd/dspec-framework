extends: level0.yaml

bounded_context: catalog
consistency_groups:
  - id: Product
    name: Product
  - id: Variant
    name: Variant
commands:
  - id: ActivateProduct
    name: ActivateProduct
    target: Product
    intent: 'Publish product under a Brand'
    preconditions: ['unique-model-code-per-brand']
    postconditions:
      emits: ['ProductActivated']
      transitions: ['Draft -> Active']
    transactional_expectation: 'starts-saga' # if using reservation-then-confirm
    failure_modes:
      - violates: 'unique-model-code-per-brand'
        outcome: 'reject DuplicateModelCode'

  - id: ActivateVariant
    name: ActivateVariant
    target: Variant
    intent: 'Publish purchasable SKU'
    preconditions: ['variant-sku-unique-per-product']
    postconditions:
      emits: ['VariantActivated']