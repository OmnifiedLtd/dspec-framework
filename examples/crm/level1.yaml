extends: feature.crm # Placeholder since no Level-0 exists

bounded_context: crm
consistency_groups:
  - id: Lead
    name: Lead
  - id: Quote
    name: Quote
  - id: Contract
    name: Contract
commands:
  - id: ConvertLead
    name: ConvertLead
    target: Lead
    intent: 'Create/link Account and optionally Opportunity'
    preconditions: []
    postconditions:
      emits: ['LeadConverted']

  - id: AcceptQuote
    name: AcceptQuote
    target: Quote
    intent: 'Customer accepts terms for a single Opportunity'
    preconditions: ['quote-aligns-with-opp']
    postconditions:
      emits: ['QuoteAccepted']

  - id: ActivateContract
    name: ActivateContract
    target: Contract
    intent: 'Make contract effective'
    preconditions:
      ['contract-after-won', 'one-active-contract-per-account-offering']
    postconditions:
      emits: ['ContractActivated']