extends: feature.crm # Placeholder since no Level-0 exists

consistency_groups:
  - id: lead
    name: Lead
  - id: quote
    name: Quote
  - id: contract
    name: Contract
commands:
  - id: convert-lead
    name: ConvertLead
    target: lead
    intent: 'Create/link Account and optionally Opportunity'
    preconditions: []
    postconditions:
      emits: ['lead-converted']

  - id: accept-quote
    name: AcceptQuote
    target: quote
    intent: 'Customer accepts terms for a single Opportunity'
    preconditions: ['quote-aligns-with-opp']
    postconditions:
      emits: ['quote-accepted']

  - id: activate-contract
    name: ActivateContract
    target: contract
    intent: 'Make contract effective'
    preconditions:
      ['contract-after-won', 'one-active-contract-per-account-offering']
    postconditions:
      emits: ['contract-activated']

queries:
  - id: get-lead
    name: GetLead
    intent: 'View lead details and status'
    parameters:
      - name: leadId
        type: string
    returns:
      type: LeadDetails
      description: 'Lead contact info and current pipeline status'