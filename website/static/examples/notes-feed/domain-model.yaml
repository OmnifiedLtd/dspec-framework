meta:
  id: notes-domain
  version: 0.1.0
  owner: Social Team

glossary:
  - id: user
    name: User
    definition: "A registered participant in the system."
  - id: note
    name: Note
    definition: "A short text message created by a User."
  - id: feed
    name: Feed
    definition: "A reverse-chronological collection of Notes created by a specific User."

lifecycles:
  note:
    states: 
      - id: draft
        name: Draft
      - id: published
        name: Published
      - id: deleted
        name: Deleted
    transitions:
      - "draft -> published"
      - "published -> deleted"
      - "draft -> deleted"

invariants:
  - id: note-author-ownership
    rule: "A Note belongs to exactly one Author (User) and cannot be reassigned."
  - id: note-length-limit
    rule: "A Note's content must not exceed 280 characters."
  - id: author-modification-only
    rule: "Only the Author of a Note may modify its content or state."

events:
  - id: note-created
    name: NoteCreated
    definition: "NoteCreated(subject: Note, author: User, occurred: Time)"
  - id: note-published
    name: NotePublished
    definition: "NotePublished(subject: Note, occurred: Time)"
  - id: note-content-updated
    name: NoteContentUpdated
    definition: "NoteContentUpdated(subject: Note, occurred: Time)"
  - id: note-deleted
    name: NoteDeleted
    definition: "NoteDeleted(subject: Note, occurred: Time)"