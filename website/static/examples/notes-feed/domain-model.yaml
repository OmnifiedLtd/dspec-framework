meta:
  id: notes_domain
  version: 0.1.0
  owner: Social Team

glossary:
  - id: user
    name: User
    definition: "A registered participant in the system."
  - id: note
    name: Note
    definition: "A short text message created by a User."
  - id: feed
    name: Feed
    definition: "A reverse-chronological collection of Notes created by a specific User."

lifecycles:
  note:
    states: 
      - "draft"
      - "published"
      - "deleted"
    transitions:
      - "draft -> published"
      - "published -> deleted"
      - "draft -> deleted"

invariants:
  - id: note_author_ownership
    rule: "A Note belongs to exactly one Author (User) and cannot be reassigned."
  - id: note_length_limit
    rule: "A Note's content must not exceed 280 characters."
  - id: author_modification_only
    rule: "Only the Author of a Note may modify its content or state."

events:
  - id: note_created
    name: NoteCreated
    definition: "NoteCreated(subject: Note, author: User, occurred: Time)"
  - id: note_published
    name: NotePublished
    definition: "NotePublished(subject: Note, occurred: Time)"
  - id: note_content_updated
    name: NoteContentUpdated
    definition: "NoteContentUpdated(subject: Note, occurred: Time)"
  - id: note_deleted
    name: NoteDeleted
    definition: "NoteDeleted(subject: Note, occurred: Time)"