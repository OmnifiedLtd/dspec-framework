extends: level0.yaml

bounded_context: catalog
consistency_groups:
  - id: product
    name: Product
  - id: variant
    name: Variant
commands:
  - id: activate_product
    name: ActivateProduct
    target: product
    intent: 'Publish product under a Brand'
    preconditions: ['unique_model_code_per_brand']
    postconditions:
      emits: ['product_activated']
      transitions: ['draft -> active']
    transactional_expectation: 'starts-saga' # if using reservation-then-confirm
    failure_modes:
      - violates: 'unique_model_code_per_brand'
        outcome: 'reject duplicate_model_code'

  - id: activate_variant
    name: ActivateVariant
    target: variant
    intent: 'Publish purchasable SKU'
    preconditions: ['variant_sku_unique_per_product']
    postconditions:
      emits: ['variant_activated']